{% extends "base.html" %}  

{% block content %}  
<div class="student-profile">  
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø—Ä–æ—Ñ–∏–ª—è -->  
    <div class="profile-header">  
        <div class="profile-photo">  
            <img src="{{ url_for('static', filename='img/students/' + student.photo) }}"  
                 alt="–§–æ—Ç–æ —É—á–µ–Ω–∏–∫–∞"  
                 onerror="this.src='{{ url_for('static', filename='img/students/nkvtf.jpg') }}'">  
        </div>  
        <div class="profile-info">  
            <h2>{{ student.name }}</h2>  
            <p><strong>–£—Ä–æ–≤–µ–Ω—å:</strong> {{ student.level }}</p>  
            
            {% if session.user.is_admin or session.user.username == student.username %}  
            <button class="edit-btn" id="edit-profile-btn">‚úçÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>  
            {% endif %}  
        </div>  
    </div>  

    <!-- –ß–∞—Ç -->  
    <div class="chat-container">  
        <div id="chat-messages">  
            {% for message in messages %}  
            <div class="message {% if message.sender == session.user.username %}my-message{% endif %}">  
                <p>{{ message.text }}</p>  
                {% if message.file %}  
                <div class="message-file">  
                    <img src="{{ message.file }}" alt="–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª">  
                </div>  
                {% endif %}  
                <span class="message-time">{{ message.timestamp }}</span>  
            </div>  
            {% endfor %}  
        </div>  
        
        <!-- –§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ -->  
        <form id="chat-form">  
            <div class="message-input">  
                <input type="text" id="message-input" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">  
                <label for="file-input" class="file-upload-btn">üìé</label>  
                <input type="file" id="file-input" accept="image/*">  
                <button type="submit" class="send-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>  
            </div>  
        </form>  
    </div>  
</div>  

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->  
{% if session.user.is_admin or session.user.username == student.username %}  
<div id="edit-modal" class="modal">  
    <div class="modal-content">  
        <span class="close-btn">&times;</span>  
        <h3>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è</h3>  
        <form method="POST" action="/update_student_profile" enctype="multipart/form-data">  
            <input type="hidden" name="student_id" value="{{ student.id }}">  
            <div class="form-row">  
                <label>–ò–º—è:</label>  
                <input type="text" name="name" value="{{ student.name }}" required>  
            </div>  
            <div class="form-row">  
                <label>–£—Ä–æ–≤–µ–Ω—å:</label>  
                <input type="text" name="level" value="{{ student.level }}" required>  
            </div>  
            <div class="form-row">  
                <label>–§–æ—Ç–æ:</label>  
                <input type="file" name="photo" accept="image/*">  
            </div>  
            <button type="submit" class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>  
        </form>  
    </div>  
</div>  
{% endif %}  
{% endblock %}  